<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title></title>
  <meta name="description" content="">
  <link rel="stylesheet" href="ext/webmaker-nav.css">
  <link rel="stylesheet" href="login.ui.css">
  <style>
    body {
      margin: 0;
    }
    #app-iframe {
      border: 0;
      position: fixed;
      opacity: 0.5;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    #webmaker-nav {
      position: relative;
      z-index: 2;
    }

  </style>
  <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
  <script src="http://localhost:3000/js/sso.js"></script>
  <script type="text/javascript">
    $(function(){
      // App 1 / App 2 differences
      var appNumber = (document.location.port - 3000),
          personaSSO = navigator.personaSSO;
      document.title = "App " + appNumber;
      if ( appNumber === 1 ) {
        $( "#app-iframe" ).attr( "src", "https://popcorn.webmaker.org/templates/basic/" );
      } else {
        $( "#app-iframe" ).attr( "src", "https://thimble.webmaker.org/p/lzw6/" );
      }

      personaSSO.init( document.getElementById("SSO") );
      personaSSO.id.watch({
        onlogin: function(topic, data){
          personaSSO.ui.checkMaker(data, $('#webmaker-nav'));
        },
        onlogout: function(){
          personaSSO.ui.loggedOut();
        }
      });
    });
  </script>
</head>
<body>
  <div id="webmaker-nav">
    <nav class="webmaker-nav-container">
      <ul class="webmaker-nav primary">
        <li><a>Webmaker</a></li>
        <li><a href="http://localhost:3001">Popcorn</a></li>
        <li><a href="http://localhost:3002">Thimble</a></li>
      </ul>

      <ul class="webmaker-nav user-info">
        <li class="user">
          <div class="user-name">
            <span id="identity" class="user-name-container"></span>
          </div>
        </li>
        <li><iframe id="SSO"></iframe></li>
      </ul>
    </nav>
  </div>
  <iframe id="app-iframe"></iframe>
</body>
</html>
